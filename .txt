
const express = require("express");
const router = express.Router();
const { authMiddleware } = require("../controller/authController");
const crudController = require("../controller/crudController");

// Root Route
router.get("/", authMiddleware, crudController.getAllUsers);

// Add user route
router.get("/add-user", (req, res) => {
  res.render("add_user");
});

// Update user route
router.get("/update-user", (req, res) => {
  axios
    .get("http://localhost:3000/api/users", { params: { id: req.query.id } })
    .then(function (userdata) {
      res.render("update_user", { user: userdata.data });
    })
    .catch((err) => {
      res.send(err);
    });
});

// API routes
router.get("/api/users", crudController.getAllUsers);
router.get("/api/users/:id", crudController.getUserById);
router.post("/api/users", crudController.createUser);
router.put("/api/users/:id", crudController.updateUser);
router.delete("/api/users/:id", crudController.deleteUser);

module.exports = router;
